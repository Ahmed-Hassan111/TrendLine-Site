<div *ngIf="showChatbot" class="chatbot-container">
  <!-- AI Bot Button -->
  <button class="chatbot-btn" (click)="toggleChat()" [class.active]="isOpen">
    <div class="bot-icon" *ngIf="!isOpen">
      <svg viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
        <!-- Main Head -->
        <rect x="6" y="8" width="20" height="16" rx="4" fill="white" />
        <!-- Eyes -->
        <circle cx="12" cy="14" r="2" fill="#4F46E5" />
        <circle cx="20" cy="14" r="2" fill="#4F46E5" />
        <circle cx="12" cy="14" r="0.8" fill="white" />
        <circle cx="20" cy="14" r="0.8" fill="white" />
        <!-- Mouth -->
        <rect x="14" y="18" width="4" height="1.5" rx="0.75" fill="#4F46E5" />
        <!-- Antennas -->
        <circle cx="10" cy="6" r="1.5" fill="#4F46E5" />
        <circle cx="22" cy="6" r="1.5" fill="#4F46E5" />
        <line x1="10" y1="8" x2="10" y2="6" stroke="white" stroke-width="1" />
        <line x1="22" y1="8" x2="22" y2="6" stroke="white" stroke-width="1" />
        <!-- Neural Network Pattern -->
        <circle cx="16" cy="12" r="0.5" fill="#4F46E5" opacity="0.3" />
        <line
          x1="12"
          y1="14"
          x2="16"
          y2="12"
          stroke="#4F46E5"
          stroke-width="0.3"
          opacity="0.3"
        />
        <line
          x1="20"
          y1="14"
          x2="16"
          y2="12"
          stroke="#4F46E5"
          stroke-width="0.3"
          opacity="0.3"
        />
      </svg>
      <div class="pulse-ring"></div>
      <div class="ai-particles">
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
      </div>
    </div>
    <div class="close-icon" *ngIf="isOpen">โ</div>
  </button>

  <!-- Chat Window -->
  <div class="chat-window" *ngIf="isOpen" [@slideInOut]>
    <!-- Header -->
    <div class="chat-header">
      <div class="bot-avatar">
        <svg viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
          <!-- Main Head -->
          <rect x="6" y="8" width="20" height="16" rx="4" fill="white" />
          <!-- Eyes -->
          <circle cx="12" cy="14" r="2" fill="#4F46E5" />
          <circle cx="20" cy="14" r="2" fill="#4F46E5" />
          <circle cx="12" cy="14" r="0.8" fill="white" />
          <circle cx="20" cy="14" r="0.8" fill="white" />
          <!-- Mouth -->
          <rect x="14" y="18" width="4" height="1.5" rx="0.75" fill="#4F46E5" />
          <!-- Antennas -->
          <circle cx="10" cy="6" r="1.5" fill="white" />
          <circle cx="22" cy="6" r="1.5" fill="white" />
          <line
            x1="10"
            y1="8"
            x2="10"
            y2="6"
            stroke="#4F46E5"
            stroke-width="1"
          />
          <line
            x1="22"
            y1="8"
            x2="22"
            y2="6"
            stroke="#4F46E5"
            stroke-width="1"
          />
        </svg>
      </div>
      <div class="header-text">
        <h3>AI Assistant</h3>
        <p class="status">
          <span class="online-dot"></span>
          ูุชุตู ุงูุขู
        </p>
      </div>
      <button class="close-btn" (click)="closeChat()">โ</button>
    </div>

    <!-- Chat Body -->
    <div class="chat-body">
      <!-- Welcome Message -->
      <div class="message bot-message">
        <div class="message-content">
          ูุฑุญุจุง! ๐ ุฃูุง ูุณุงุนุฏู ุงูุฐูู. ููู ูููููู ูุณุงุนุฏุชู ุงููููุ
        </div>
      </div>

      <!-- Typing Indicator -->
      <div class="message bot-message typing-indicator" *ngIf="isTyping">
        <div class="typing-dots">
          <span></span>
          <span></span>
          <span></span>
        </div>
      </div>

      <!-- Services -->
      <div class="services-grid" *ngIf="!isTyping">
        <button
          class="service-btn"
          *ngFor="let service of services; trackBy: trackByServiceId"
          (click)="onServiceClick(service)"
        >
          <div class="service-icon">{{ service.icon }}</div>
          <span>{{ service.name }}</span>
        </button>
      </div>
    </div>

    <!-- Footer -->
    <!-- <div class="chat-footer">
      <p class="powered-by">ูุฏุนูู ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู โจ</p>
    </div> -->
  </div>
</div>
